### PÃ¡gina **Arquivos** â€” o â€œDriveâ€ central do Portal Content Crush

Objetivo: dar um lugar Ãºnico para localizar, prÃ©-visualizar e gerenciar todos os arquivos vindos de clientes, projetos, tarefas e finanÃ§as, sem perder o contexto de origem e com controle de espaÃ§o em disco.

---

## 1. Estrutura visual

```
â”Œâ”€â”€ Topbar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
ğŸ”  Pesquisa (nome, tipo, origem)          |  EspaÃ§o:  68 GB / 100 GB â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–  (Ver detalhes)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€ Breadcrumb / Filtros â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 Todos  â–¸  Projeto  â–¸  Tarefa
  â€¢ Tipo â–¾  â€¢ Projeto â–¾  â€¢ Cliente â–¾  â€¢ PerÃ­odo â–¾
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€ Painel lateral (toggle) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€ Grade / Lista â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Favoritos                                  â”‚   â”‚ â–² Nome         Origem  Peso  â”‚
â”‚  â€¢ Scripts padrÃ£o.mp4                      â”‚   â”‚  VÃ­deo_final_1.mp4  Projeto 320 MB â”‚
â”‚ Pastas recentes                            â”‚   â”‚  Briefing.pdf        Cliente  2 MB â”‚
â”‚  â€¢ Banco Azul                              â”‚   â”‚  ...                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

* **Grade** (miniaturas) â†” **Lista** (detalhes) switch.
* Arquivos agrupados por â€œpasta virtualâ€ = cliente / projeto / tarefa â€” nÃ£o hÃ¡ pastas fÃ­sicas.
* Upload drag-and-drop sempre disponÃ­vel.

---

## 2. NavegaÃ§Ã£o e filtros

| Ferramenta       | O que faz                                                                                                                                                           |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Busca global** | Indexa nome, extensÃ£o, tags e campo â€œdescriÃ§Ã£oâ€ adicionado na tarefa.                                                                                               |
| **Filtros**      | â€¢ Tipo (vÃ­deo, documento, imagem, Ã¡udio, planilha) <br>â€¢ Origem (Cliente, Projeto, Tarefa, Financeiro) <br>â€¢ ResponsÃ¡vel (uploader) <br>â€¢ Data (Ãºltimos 30 d, 90 d) |
| **Breadcrumb**   | Clica na migalha para subir nÃ­vel logicamente (Projeto â†’ Cliente â†’ Todos).                                                                                          |
| **Favoritar** â­  | Marca item ou â€œpasta virtualâ€ para acesso rÃ¡pido no painel lateral.                                                                                                 |

---

## 3. CartÃ£o / linha de arquivo

| Elemento      | Detalhe                                                                                    |
| ------------- | ------------------------------------------------------------------------------------------ |
| Ãcone/Thumb   | Mostra preview (imagem) ou extensÃ£o genÃ©rica (PDF, DOC).                                   |
| Nome editÃ¡vel | Duplo-clique renomeia (sem mudar URL).                                                     |
| Origem        | Link â€œProjeto Banco Azulâ€ â†’ abre projeto num novo tab.                                     |
| Peso          | Exibe MB/GB; badge vermelho se >1 GB (alerta de espaÃ§o).                                   |
| AÃ§Ãµes rÃ¡pidas | Download Â· Copiar link Â· Mover (seleciona nova origem) Â· Deletar Â· VersÃµes (se aplicÃ¡vel). |

---

## 4. Barra de espaÃ§o em disco

* Top-right widget: â€œ68 GB / 100 GB â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–â€.
* Cor muda para laranja a 80 % e vermelho a 95 %.
* Clique â†’ modal â€œUso de espaÃ§oâ€ com pizza por tipo (vÃ­deo 78 %, docs 12 %, etc.) e por cliente (TOP 5).

Back-end: consulta `SUM(size)` de `attachments`; cron a cada hora grava em `storage_stats` para nÃ£o pesar.

---

## 5. GestÃ£o em lote

* Checkbox multi-seleÃ§Ã£o.
* Barra flutuante: **Mover paraâ€¦ Â· Download ZIP Â· Deletar Â· Compartilhar link**.
* Progresso em tempo real (WebSocket) para uploads/downloads grandes.

---

## 6. SeguranÃ§a & permissÃµes

| Papel                                                                                       | Ver                                            | Upload | Deletar              |
| ------------------------------------------------------------------------------------------- | ---------------------------------------------- | ------ | -------------------- |
| Admin                                                                                       | Todos                                          | âœ”      | âœ”                    |
| Gestor                                                                                      | Arquivos de projetos sob sua gestÃ£o + clientes | âœ”      | âœ”                    |
| Creator                                                                                     | Arquivos de projetos onde Ã© membro             | âœ”      | Apenas os que enviou |
| *Back-end valida `canViewFile(userId, fileId)` usando FK `project_id` + `project_members`.* |                                                |        |                      |

---

## 7. Futuro-proof (notificaÃ§Ãµes externas)

* Cada upload dispara `publishEvent('file_uploaded', meta)` â†’ jÃ¡ entra no sistema de notificaÃ§Ãµes.
* Campo `public_url` pronto: um toggle â€œGerar link pÃºblico (expira 7 d)â€ utiliza Cloudflare/S3 presigned.
* Webhook outbound (Zapier) pode ouvir `file_uploaded` para auto-postar no Slack.

---

## 8. Performance

* **VirtualizaÃ§Ã£o** (`react-window`) em lista > 500.
* Thumbnails gerados server-side (Lambda\@Edge) e cacheados.
* Lazy fetch de metadata; download link sÃ³ assinado on-click (reduz custo STORAGE e tratamento 403).

---

### Resultado

Uma tela Ãºnica, com busca unificada, filtros contextuais e visÃ£o clara de espaÃ§o em disco â€” tornando arquivos de cliente, projeto e tarefa tÃ£o fÃ¡ceis de achar quanto em um drive dedicado, sem quebrar a lÃ³gica de permissÃµes jÃ¡ existente.
